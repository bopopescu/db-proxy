#
# BUG #46456: HANDLER OPEN + TRUNCATE + DROP (temporary) TABLE, crash 
#
CREATE TABLE t1 AS SELECT 1 AS f1;
HANDLER t1 OPEN;
TRUNCATE t1;
HANDLER t1 READ FIRST;
ERROR 42S02: Unknown table 't1' in HANDLER
DROP TABLE t1;
CREATE TEMPORARY TABLE t1 AS SELECT 1 AS f1;
HANDLER t1 OPEN;
TRUNCATE t1;
HANDLER t1 READ FIRST;
ERROR 42S02: Unknown table 't1' in HANDLER
DROP TABLE t1;
#
# BUG#51877 - HANDLER interface causes invalid memory read
#
CREATE TABLE t1(a INT, KEY(a));
HANDLER t1 OPEN;
HANDLER t1 READ a FIRST;
a
INSERT INTO t1 VALUES(1);
HANDLER t1 READ a NEXT;
a
HANDLER t1 CLOSE;
DROP TABLE t1;
#
# Bug #54007: assert in ha_myisam::index_next , HANDLER
#
CREATE TABLE t1(a INT, b INT, PRIMARY KEY(a), KEY b(b), KEY ab(a, b));
HANDLER t1 OPEN;
HANDLER t1 READ FIRST;
a	b
HANDLER t1 READ `PRIMARY` NEXT;
a	b
HANDLER t1 READ ab NEXT;
a	b
HANDLER t1 READ b NEXT;
a	b
HANDLER t1 READ NEXT;
a	b
HANDLER t1 CLOSE;
INSERT INTO t1 VALUES (2, 20), (1, 10), (4, 40), (3, 30);
HANDLER t1 OPEN;
HANDLER t1 READ FIRST;
a	b
1	10
HANDLER t1 READ NEXT;
a	b
2	20
HANDLER t1 READ `PRIMARY` NEXT;
a	b
3	30
HANDLER t1 READ `PRIMARY` NEXT;
a	b
4	40
HANDLER t1 READ ab NEXT;
a	b
1	10
HANDLER t1 READ ab NEXT;
a	b
2	20
HANDLER t1 READ b NEXT;
a	b
1	10
HANDLER t1 READ b NEXT;
a	b
2	20
HANDLER t1 READ b NEXT;
a	b
3	30
HANDLER t1 READ b NEXT;
a	b
4	40
HANDLER t1 READ b NEXT;
a	b
HANDLER t1 READ NEXT;
a	b
HANDLER t1 READ NEXT;
a	b
HANDLER t1 READ NEXT;
a	b
HANDLER t1 CLOSE;
HANDLER t1 OPEN;
HANDLER t1 READ FIRST;
a	b
1	10
HANDLER t1 READ `PRIMARY` PREV;
a	b
HANDLER t1 READ `PRIMARY` PREV;
a	b
HANDLER t1 READ b PREV;
a	b
4	40
HANDLER t1 READ b PREV;
a	b
3	30
HANDLER t1 CLOSE;
HANDLER t1 OPEN;
HANDLER t1 READ FIRST;
a	b
1	10
HANDLER t1 READ `PRIMARY` PREV LIMIT 3;
a	b
HANDLER t1 READ b NEXT LIMIT 5;
a	b
1	10
2	20
3	30
4	40
HANDLER t1 CLOSE;
DROP TABLE t1;
End of 5.1 tests
